
##Turn Spooling on
spool /usr/share/scripts/pentesting/output/msf/spool/msf_spool.txt

setg THREADS 1

echo "####ADDITIONAL CHECKS####"

echo "udp_probe - Detect common UDP services using sequential probes"
use auxiliary/scanner/discovery/udp_probe
hosts -R
run
sleep 5

echo "udp_sweep - Detect interesting UDP Services"
use auxiliary/scanner/discovery/udp_sweep
hosts -R
run
sleep 5

echo "####DNS####"

echo "DNS Amplification Scanner"
use auxiliary/scanner/dns/dns_amp
hosts -R
run
sleep 5

echo "####SNMP####"

echo "snmp_login - This module logs in to SNMP devices using common community names"
use auxiliary/scanner/snmp/snmp_login
services -u -p 161 -R
set VERSION all
run
sleep 5

echo "####FTP####"

echo "ftp_version - Detect FTP Version - Set password for username"
use auxiliary/scanner/ftp/ftp_version
services -u -p 21 -R
set FTPPASS ProSec_Networks
run
sleep 5

echo "anonymous - Detect anonymous read_write FTP server access"
use auxiliary/scanner/ftp/anonymous
services -u -p 21 -R
run
sleep 5

echo "####SQL####"

echo "mssql_ping - This module simply queries the MSSQL instance for information"
use auxiliary/scanner/mssql/mssql_ping
hosts -R
run
sleep 5

echo "mysql_version - Enumerates the version of MySQL servers"
use auxiliary/scanner/mysql/mysql_version
services -u -p 3306 -R
run
sleep 5

echo "postgres_version - Enumerates the version of PostgreSQL servers"
use auxiliary/scanner/postgres/postgres_version
services -u -p 5432 -R
run
sleep 5

echo "####SMB####"

echo "smb_version - Display version information about each system"
use auxiliary/scanner/smb/smb_version
hosts -R
run
sleep 5

echo "smb_enumshares - This module determines what shares are provided by the SMB service"
use auxiliary/scanner/smb/smb_enumshares
hosts -R
set ShowFiles true
set SpiderShares true
run
sleep 5

echo "smb_enumusers - Determine what local users exist via the SAM RPC service"
use auxiliary/scanner/smb/smb_enumusers
hosts -R
run
sleep 5

echo "smb_enumusers_domain - Determine what domain users are logged into a remote system via DCERPC"
use auxiliary/scanner/smb/smb_enumusers_domain
hosts -R
run
sleep 5


echo "smb_ms17_010 - Check for MS17-010 - DoublePulsar infection"
use auxiliary/scanner/smb/smb_ms17_010
services -u -p 445 -R
run
sleep 5

echo "####MAIL####"

echo "smtp_version - SMTP Banner Grabber"
use auxiliary/scanner/smtp/smtp_version
services -u -p 25 -R
run
sleep 5

echo "smtp_relay - SMTP Server e-mail accept check"
use auxiliary/scanner/smtp/smtp_relay
services -u -p 25 -R
set MAILFROM sender@prosec-networks.com
set MAILTO recipient@prosec-networks.com
set EXTENDED true
run
sleep 5

echo "smtp_enum - Enum valid SMTP users"
use auxiliary/scanner/smtp/smtp_enum
services -u -p 25 -R
set UNIXONLY false
run
sleep 5


echo "imap_version - IMAP4 Banner Grabber"
use auxiliary/scanner/imap/imap_version
services -u -p 143 -R
run
sleep 5

echo "pop3_version - POP3 Banner Grabber"
use auxiliary/scanner/pop3/pop3_version
services -u -p 110 -R
run
sleep 5

echo "####TELNET####"

echo "telnet_version - Detect telnet services"
use auxiliary/scanner/telnet/telnet_version
services -u -p 23 -R
run
sleep 5

echo "lantronix_telnet_version - Detect Lantronix telnet services"
use auxiliary/scanner/telnet/lantronix_telnet_version
services -u -p 9999 -R
run
sleep 5

echo "####SSH####"

echo "ssh_version - Detect SSH VERSION"
use auxiliary/scanner/ssh/ssh_version
services -u -s ssh -R
run
sleep 5

echo "####PRINTER####"

echo "printer_version_info - Printer Version Info via PJL"
use auxiliary/scanner/printer/printer_version_info
services -u -p 9100 -R
run
sleep 5

echo "####VM#####"

echo "esx_fingerprint - VMware ESX_ESXi Version Info via web API"
use auxiliary/scanner/vmware/esx_fingerprint
services -u -p 443 -R
run
sleep 5

echo "####RDP####"

echo "RDP Scanner"
use auxiliary/scanner/rdp/rdp_scanner
hosts -R
run
sleep 5

echo "MS12-020 Check"
use auxiliary/scanner/rdp/ms12_020_check
services -u -p 3389 -R
run
sleep 5

echo "CVE-2019-708 aka Bluekeep"
use auxiliary/scanner/rdp/cve_2019_0708_bluekeep
services -u -p 3389 -R
run
sleep 5

echo "####HTTP/HTTPS####"

echo "HTTP SSL Certificate Information"
use auxiliary/scanner/http/ssl
services -u -p 443 -R
run
sleep 5

echo "####IPMI####"

echo "IPMI Information Discovery"
use auxiliary/scanner/ipmi/ipmi_version
hosts -R
run
sleep 5


#Exports
services -o /usr/share/scripts/pentesting/output/msf/export/services.csv
hosts -u -o /usr/share/scripts/pentesting/output/msf/export/hosts.csv

spool off
